---
title: 道路交通标志检测与识别
date: 2018-11-07 15:24:07
categories: 工程实践
---

使用分割模型来进行交通标志的检测，发现有较好效果。

具体方法为：首先训练分割模型，输入一张图片，输出掩码，之后根据掩码图片，求出连通区域以及其外接矩形，即得到交通标志的位置和大小信息，使用修改后的U-net模型(去掉卷积上采样层，换成直接上采样，这个网络我称为GridU-net)，网络具体结构如下。
{% asset_img 网络结构示意图.png GridU-net %}
这个网络可以接受任意大小的输入大小，只有一个要求，长宽都是8的倍数，稍微resize一下就行。其输出与输入大小相同，主要是模型参数非常少，keras保存的模型文件只有9MB左右（U-net：93MB左右），处理1360*800的图片，这个模型在Nvidia GTX 1080Ti Gpu 上可以达到24fps(U-net:3fps)，网络训练的时候，使用了分阶段训练的策略，先使用采样出来的小图片训练，逐渐增大输入图片的大小，最后使用数据集中的原图训练，我觉得这样可以解决分割模型的正负样本比例失衡问题（分割本质上是像素点级的分类问题）

不过这样的方法问题在于：当两个目标的预测区域相连时，很难分开，不过在交通标志检测的问题里面，因为交通标志不会经常连着，所以没有什么大问题，但是我用这个网络来做人脸检测的时候就有些问题了（数据集中很多人脸在像平面上挨在一起了）

贴上一些检测结果图。
{% asset_img 交通标志检测结果.jpg 交通标志检测结果 %}
交通标志检测的图中标红的区域为输出的掩码区域

{% asset_img 人脸检测结果.png 人脸检测结果 %}