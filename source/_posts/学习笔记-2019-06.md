---
title: 学习笔记-2019-06
date: 2019-06-20 19:13:39
tags: [学习笔记，杂项]
mathjax: true
---

# 2019-06-20
## 课程学习在弱监督学习中的应用
在网上看到了关于CVPR2017 WebVision图片分类竞赛冠军的技术分享，大致整理其主要思路。

这个比赛的数据非常多，但是标签可能存在问题，要求是在存在问题标签的数据中进行模型训练。

这里主要使用了一种课程学习的思想，先让模型学习简单的样本，然后再让其学习较困难的样本，循序渐进，得到最终的训练模型。

难点在于没有先验知识的情况下定义数据集或者图片的难易程度。

其基本思想是在同一个类别的图像的特征空间中，越密集的地方的图像特征越相似，表示图片类别越可能正确，根据这个思想将图片分类成不同的难易程度，分步，使用不同权重对待不同数据，进行模型训练。

这里先介绍一种样本分析方法density-distance：对于样本$P_i$，其特征$f(P_i)$，计算所有样本之间的特征距离矩阵：$D_{ij} = {||f(P_i) - f(P_j)||} ^ 2$，定义样本密度：$\rho_i = \sum_i X(D_{ij} - d_c) \quad X(d) = \begin{cases} 1 & d < 0 \\ 0 & other \end{cases}$，其中$d_c$是一个超参数， 计算每个样本的密度距离值：$\delta_i = \begin{cases}min_{j:\rho_j > \rho_i}(D_{ij}) & if \quad \exists j s.t. \rho_j > \rho_i \\ max(D_{ij}) & otherwise \end{cases}$，将$\rho_i$和$\delta_i$相乘，值越大的说明可能在聚类中心，数据标签越可能正确。

对数据进行分类的具体实现步骤如下：

- 设计课程
  - 使用所有数据($P_i$)训练一个特征提取模型：$f$
  - 对所有样本的进行特征提取：$f(P_i)$
  - 对每个类别的图片分别进行density-distance分析
  - 按照$\rho_i \times \delta_i$结果划分出三个子类，分别代表难易度不同的图片，作为先后训练的数据
- 课程训练
  - 首先使用第一类最简单的数据进行训练
  - 为第二类数据设置权重0.5，继续训练
  - 为第三类数据设置权重0.5，继续训练

