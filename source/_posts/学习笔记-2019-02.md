---
title: 学习笔记_2019-02
date: 2019-02-13 15:16:58
tags: [学习笔记，杂项]
mathjax: true
---

# 2019-02-13

## 支持向量机
首先复习了数学上的一个小知识，如果有一个超平面可以表达为如下线性方程：
$$
\begin{aligned}
    w^Tx+b = 0
\end{aligned}
$$
则空间中任意一点$x_0$到该超平面的距离可以表示为如下：
$$
\begin{aligned}
    r = \frac{|w^Tx_0+b|}{||w||}
\end{aligned}
$$

在分类问题的样本空间中，令$x_i$和$y_i$分别表示某个样本和其对应的标签，支持向量机的基本思想是求出一个满足如下条件的超平面：
$$
\begin{cases}
    w^Tx_i + b \ge 1 & y_i = 1\\
    w^Tx_i + b \le 1 & y_i = -1
\end{cases}
$$
示意图如下,这里z展示的样本的特征空间为2维，图中被圈出来的满足上式等号条件一个正样本和两个负样本被称为支持向量，$\gamma=\frac{2}{||w||}$称为间隔。

{% asset_img 支持向量机超平面示意.png 支持向量机超平面示意%}

找分类超平面的问题就可以转化为如下：
$$
\begin{aligned}
    &\max_{w,b}\frac{2}{||w||}\\
    &s.t.\quad y_i(w^Tx_i + b) \ge 1, i = 1,2,...,m\\
    等价为\\
    &\min_{w,b}\frac{||w||^2}{2}\\
    &s.t.\quad y_i(w^Tx_i + b) \ge 1, i = 1,2,...,m
\end{aligned}
$$
这里可以使用不等式约束下的拉格朗日乘子法转换为对偶问题进行求解。

支持向量机的基本型就是希望找到一个间隔最大的超平面，但是这里有个问题，在原始的特征空间中，样本不一定线性可分，因此引入一个函数，将原始特征空间映射到一个高维的特征空间，使得在这个高维空间中线性可分，这样即可将任何分类问题转换成线性可分的形式，但是这样也有一个问题，设映射后的特征向量为$\phi(x)$，求解超平面的过程中，会遇到${\phi(x)}^T\phi(x)$的情况，因为$\phi(x)$的维数可以为无穷，所以这里的计算无法进行，因此需要设想一个这样的函数：$k(x_i,x_j)={\phi(x)}^T\phi(x)$使得不需要通过$\phi(x)$来计算${\phi(x)}^T\phi(x)$，而是直接通过$k(x_i,x_j)$来表示，这个函数即称为核函数。

核函数可以用一个核矩阵来表示如下，任何一个对称的半正定矩阵，都可以作为核矩阵。
$$
k=\begin{bmatrix}
    k(x_1,x_1) &\cdots &k(x_1,x_j) &\cdots &k(x_1,x_n)\\
    \vdots &\ddots &\vdots &\ddots &\vdots\\
    k(x_j,x_1) &\cdots &k(x_j,x_j) &\cdots &k(x_j,x_n)\\
    \vdots &\ddots &\vdots &\ddots &\vdots\\
    k(x_n,x_1) &\cdots &k(x_n,x_j) &\cdots &k(x_n,x_n)\\
\end{bmatrix}
$$

选择一个核函数，就隐式的确定了映射的特征空间，因此核函数的选择非常重要。

但是在实际使用中，选出一个合适的特征空间恰好让这个样本线性可分非常不容易，因此将优化目标重写为：
$$
\min_{w,b}\frac{1}{2}{||w||}^2+C\sum_{i=1}^ml(y_i(w^Tx_i+b) - 1)
$$
这里的$C$为一个设定好的常数，决定模型的偏好，$l$为一种损失函数。这样的支持向量机被称为软间隔支持向量机。